{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-12-09T15:30:30.990294Z", "invocation_id": "31583563-883f-4723-ab88-e66f2a30dcb9", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:28.576106Z", "completed_at": "2025-12-09T15:30:28.596579Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:28.633398Z", "completed_at": "2025-12-09T15:30:28.809183Z"}], "thread_id": "Thread-3", "execution_time": 0.2599008083343506, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.brnz_products", "compiled": true, "compiled_code": "with product as (\n    select * from \"AdventureWorks2014\".\"Production\".\"Product\"\n),\n\nproduct_subcategory as (\n    select * from \"AdventureWorks2014\".\"Production\".\"ProductSubcategory\"\n),\n\nstaged as (\n    select\n        p.ProductID,\n        p.Name as ProductName,\n        p.ProductNumber,\n        p.MakeFlag,\n        p.FinishedGoodsFlag,\n        p.Color,\n        p.SafetyStockLevel,\n        p.ReorderPoint,\n        p.StandardCost,\n        p.ListPrice,\n        p.Size,\n        p.SizeUnitMeasureCode,\n        p.WeightUnitMeasureCode,\n        p.Weight,\n        p.DaysToManufacture,\n        p.ProductLine,\n        p.Class,\n        p.Style,\n        p.ProductSubcategoryID,\n        p.ProductModelID,\n        p.SellStartDate,\n        p.SellEndDate,\n        p.DiscontinuedDate,\n        ps.Name as SubcategoryName,\n        ps.ProductCategoryID,\n        p.ModifiedDate as last_modified_date\n    from product p\n    left join product_subcategory ps\n        on p.ProductSubcategoryID = ps.ProductSubcategoryID\n)\n\nselect * from staged", "relation_name": "\"AdventureWorks2014\".\"bronze\".\"brnz_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:28.571943Z", "completed_at": "2025-12-09T15:30:28.589937Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:28.591393Z", "completed_at": "2025-12-09T15:30:28.812807Z"}], "thread_id": "Thread-2", "execution_time": 0.2666199207305908, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.brnz_example", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from \"AdventureWorks2014\".\"Sales\".\"Customer\"\n),\n\ntransformed as (\n    select\n        CustomerID as id,\n        AccountNumber as name,\n        ModifiedDate as created_at,\n        ModifiedDate as updated_at\n    from source_data\n)\n\nselect * from transformed", "relation_name": "\"AdventureWorks2014\".\"bronze\".\"brnz_example\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:28.580053Z", "completed_at": "2025-12-09T15:30:28.591029Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:28.613248Z", "completed_at": "2025-12-09T15:30:28.814571Z"}], "thread_id": "Thread-4", "execution_time": 0.26549506187438965, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.brnz_sales_orders", "compiled": true, "compiled_code": "with sales_order_header as (\n    select\n        SalesOrderID as sales_order_id,\n        OrderDate as order_date,\n        DueDate as due_date,\n        ShipDate as ship_date,\n        Status as status,\n        OnlineOrderFlag as online_order_flag,\n        SalesOrderNumber as sales_order_number,\n        PurchaseOrderNumber as purchase_order_number,\n        CustomerID as customer_id,\n        SalesPersonID as sales_person_id,\n        TerritoryID as territory_id\n    from \"AdventureWorks2014\".\"Sales\".\"SalesOrderHeader\"\n),\n\nsales_order_detail as (\n    select\n        SalesOrderDetailID as order_detail_id,\n        SalesOrderID as sales_order_id,\n        ProductID as product_id,\n        OrderQty as order_qty,\n        UnitPrice as unit_price,\n        UnitPriceDiscount as unit_price_discount,\n        LineTotal as line_total\n    from \"AdventureWorks2014\".\"Sales\".\"SalesOrderDetail\"\n)\n\nselect\n    h.sales_order_id,\n    h.order_date,\n    h.due_date,\n    h.ship_date,\n    h.status,\n    h.online_order_flag,\n    h.sales_order_number,\n    h.purchase_order_number,\n    h.customer_id,\n    h.sales_person_id,\n    h.territory_id,\n    d.order_detail_id,\n    d.product_id,\n    d.order_qty,\n    d.unit_price,\n    d.unit_price_discount,\n    d.line_total\nfrom sales_order_header h\nleft join sales_order_detail d\n    on h.sales_order_id = d.sales_order_id", "relation_name": "\"AdventureWorks2014\".\"bronze\".\"brnz_sales_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:28.561774Z", "completed_at": "2025-12-09T15:30:28.607571Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:28.637525Z", "completed_at": "2025-12-09T15:30:28.819456Z"}], "thread_id": "Thread-1", "execution_time": 0.27385735511779785, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.brnz_customers", "compiled": true, "compiled_code": "\n\nwith source as (\n    select * from \"AdventureWorks2014\".\"Sales\".\"Customer\"\n),\n\nperson as (\n    select * from \"AdventureWorks2014\".\"Person\".\"Person\"\n),\n\nstaged as (\n    select\n        c.CustomerID,\n        p.FirstName,\n        p.LastName,\n        p.EmailPromotion,\n        c.StoreID,\n        c.TerritoryID,\n        c.ModifiedDate as last_modified_date\n    from source c\n    left join person p\n        on c.PersonID = p.BusinessEntityID\n)\n\nselect * from staged", "relation_name": "\"AdventureWorks2014\".\"bronze\".\"brnz_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:28.843502Z", "completed_at": "2025-12-09T15:30:28.861793Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:28.863043Z", "completed_at": "2025-12-09T15:30:29.083775Z"}], "thread_id": "Thread-3", "execution_time": 0.24845266342163086, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.slvr_products", "compiled": true, "compiled_code": "\n\nwith bronze_products as (\n    select * from \"AdventureWorks2014\".\"bronze\".\"brnz_products\"\n),\n\ncleaned as (\n    select\n        ProductID as product_id,\n        ProductName as product_name,\n        ProductNumber as product_number,\n        coalesce(Color, 'N/A') as color,\n        StandardCost as standard_cost,\n        ListPrice as list_price,\n        coalesce(Size, 'N/A') as size,\n        coalesce(Weight, 0) as weight,\n        ProductLine as product_line,\n        Class as class,\n        Style as style,\n        ProductSubcategoryID as subcategory_id,\n        coalesce(SubcategoryName, 'Uncategorized') as subcategory_name,\n        ProductCategoryID as category_id,\n        SellStartDate as sell_start_date,\n        SellEndDate as sell_end_date,\n        case \n            when DiscontinuedDate is not null then 1\n            else 0\n        end as is_discontinued,\n        last_modified_date\n    from bronze_products\n)\n\nselect * from cleaned", "relation_name": "\"AdventureWorks2014\".\"silver\".\"slvr_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:28.856660Z", "completed_at": "2025-12-09T15:30:28.890705Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:28.898978Z", "completed_at": "2025-12-09T15:30:29.212463Z"}], "thread_id": "Thread-4", "execution_time": 0.36560916900634766, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.slvr_customers", "compiled": true, "compiled_code": "\n\nwith bronze_customers as (\n    select * from \"AdventureWorks2014\".\"bronze\".\"brnz_customers\"\n),\n\ncleaned as (\n    select\n        CustomerID as customer_id,\n        coalesce(FirstName, 'Unknown') as first_name,\n        coalesce(LastName, 'Unknown') as last_name,\n        concat(coalesce(FirstName, 'Unknown'), ' ', coalesce(LastName, 'Unknown')) as full_name,\n        EmailPromotion as email_promotion,\n        StoreID as store_id,\n        TerritoryID as territory_id,\n        last_modified_date\n    from bronze_customers\n)\n\nselect * from cleaned", "relation_name": "\"AdventureWorks2014\".\"silver\".\"slvr_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:28.849961Z", "completed_at": "2025-12-09T15:30:28.862290Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:28.884439Z", "completed_at": "2025-12-09T15:30:29.994755Z"}], "thread_id": "Thread-2", "execution_time": 1.154395580291748, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.slvr_sales_orders", "compiled": true, "compiled_code": "\n\nwith bronze_sales as (\n    select * from \"AdventureWorks2014\".\"bronze\".\"brnz_sales_orders\"\n),\n\ncleaned as (\n    select\n        sales_order_id,\n        order_detail_id,\n        order_date,\n        due_date,\n        ship_date,\n        status,\n        case \n            when online_order_flag = 1 then 'Online'\n            else 'Offline'\n        end as order_channel,\n        sales_order_number,\n        purchase_order_number,\n        customer_id,\n        sales_person_id,\n        territory_id,\n        product_id,\n        order_qty,\n        unit_price,\n        unit_price_discount,\n        line_total,\n        -- Calculated fields\n        unit_price * order_qty as gross_amount,\n        line_total / nullif(order_qty, 0) as effective_unit_price,\n        case \n            when unit_price_discount > 0 then 1\n            else 0\n        end as has_discount\n    from bronze_sales\n    where order_qty > 0\n        and unit_price >= 0\n)\n\nselect * from cleaned", "relation_name": "\"AdventureWorks2014\".\"silver\".\"slvr_sales_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:30.012164Z", "completed_at": "2025-12-09T15:30:30.037402Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:30.040817Z", "completed_at": "2025-12-09T15:30:30.609748Z"}], "thread_id": "Thread-1", "execution_time": 0.6047830581665039, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.gld_customer_metrics", "compiled": true, "compiled_code": "\n\nwith customers as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_customers\"\n),\n\nsales as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_sales_orders\"\n),\n\ncustomer_sales as (\n    select\n        c.customer_id,\n        c.full_name,\n        c.territory_id,\n        count(distinct s.sales_order_id) as total_orders,\n        sum(s.line_total) as total_revenue,\n        avg(s.line_total) as avg_order_value,\n        sum(s.order_qty) as total_items_purchased,\n        min(s.order_date) as first_order_date,\n        max(s.order_date) as last_order_date,\n        sum(case when s.has_discount = 1 then 1 else 0 end) as orders_with_discount\n    from customers c\n    left join sales s\n        on c.customer_id = s.customer_id\n    group by c.customer_id, c.full_name, c.territory_id\n)\n\nselect * from customer_sales", "relation_name": "\"AdventureWorks2014\".\"gold\".\"gld_customer_metrics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:30.017529Z", "completed_at": "2025-12-09T15:30:30.039538Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:30.050972Z", "completed_at": "2025-12-09T15:30:30.973320Z"}], "thread_id": "Thread-3", "execution_time": 0.96858811378479, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.gld_product_performance", "compiled": true, "compiled_code": "\n\nwith products as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_products\"\n),\n\nsales as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_sales_orders\"\n),\n\nproduct_sales as (\n    select\n        p.product_id,\n        p.product_name,\n        p.subcategory_name,\n        p.color,\n        p.list_price,\n        p.standard_cost,\n        count(distinct s.sales_order_id) as total_orders,\n        sum(s.order_qty) as total_quantity_sold,\n        sum(s.line_total) as total_revenue,\n        avg(s.unit_price) as avg_selling_price,\n        sum(s.line_total) - (sum(s.order_qty) * p.standard_cost) as total_profit,\n        case \n            when sum(s.order_qty) > 0 then \n                (sum(s.line_total) - (sum(s.order_qty) * p.standard_cost)) / sum(s.line_total) * 100\n            else 0\n        end as profit_margin_pct\n    from products p\n    left join sales s\n        on p.product_id = s.product_id\n    group by \n        p.product_id, \n        p.product_name, \n        p.subcategory_name, \n        p.color, \n        p.list_price, \n        p.standard_cost\n)\n\nselect * from product_sales", "relation_name": "\"AdventureWorks2014\".\"gold\".\"gld_product_performance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-09T15:30:30.022607Z", "completed_at": "2025-12-09T15:30:30.046046Z"}, {"name": "execute", "started_at": "2025-12-09T15:30:30.061083Z", "completed_at": "2025-12-09T15:30:30.974743Z"}], "thread_id": "Thread-4", "execution_time": 0.9682908058166504, "adapter_response": {"_message": "OK", "rows_affected": -1}, "message": "OK", "failures": null, "unique_id": "model.dbt_sqlserver_project.gld_sales_summary", "compiled": true, "compiled_code": "\n\nwith sales as (\n    select * from \"AdventureWorks2014\".\"silver\".\"slvr_sales_orders\"\n),\n\ndaily_summary as (\n    select\n        cast(order_date as date) as order_date,\n        count(distinct sales_order_id) as total_orders,\n        count(distinct customer_id) as unique_customers,\n        sum(order_qty) as total_items_sold,\n        sum(line_total) as total_revenue,\n        avg(line_total) as avg_order_line_value,\n        sum(case when order_channel = 'Online' then 1 else 0 end) as online_orders,\n        sum(case when order_channel = 'Offline' then 1 else 0 end) as offline_orders,\n        sum(case when has_discount = 1 then line_total else 0 end) as discounted_revenue\n    from sales\n    group by cast(order_date as date)\n)\n\nselect * from daily_summary", "relation_name": "\"AdventureWorks2014\".\"gold\".\"gld_sales_summary\""}], "elapsed_time": 2.568938970565796, "args": {"defer": false, "source_freshness_run_project_hooks": false, "printer_width": 80, "vars": {}, "write_json": true, "static_parser": true, "log_level_file": "debug", "send_anonymous_usage_stats": true, "use_colors_file": true, "log_format": "default", "partial_parse_file_diff": true, "project_dir": "/usr/app/dbt", "exclude": [], "invocation_command": "dbt run --fail-fast", "log_file_max_bytes": 10485760, "macro_debugging": false, "version_check": true, "populate_cache": true, "profiles_dir": "/usr/app/dbt", "strict_mode": false, "fail_fast": true, "require_resource_names_without_spaces": false, "quiet": false, "log_format_file": "debug", "cache_selected_only": false, "use_colors": true, "log_level": "info", "enable_legacy_logger": false, "select": [], "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "which": "run", "warn_error_options": {"include": [], "exclude": []}, "introspect": true, "favor_state": false, "show_resource_report": false, "log_path": "/usr/app/dbt/logs", "indirect_selection": "eager", "empty": false, "partial_parse": true}}